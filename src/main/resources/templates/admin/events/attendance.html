<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="'Attendance for ' + ${event.name}">Attendance</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">
     <h2 th:text="'Attendance for ' + ${event.name}">Event Attendance</h2>
    <p>
        <strong>Date:</strong>
        <span th:text="${#temporals.format(event.dateTime, 'yyyy-MM-dd HH:mm')}"></span><br>
        <strong>Venue:</strong> <span th:text="${event.venue}"></span><br>
        <strong>Category:</strong> <span th:text="${event.category}"></span>
    </p>

    <!-- Flash messages -->
    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

    <table class="table table-bordered mt-3">
        <thead class="table-dark">
        <tr>
            <th>User Email</th>
            <th>Registered At</th>
            <th>Attended</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="reg : ${registrations}">
            <td th:text="${reg.userEmail}">user@example.com</td>
            <td th:text="${#temporals.format(reg.registeredAt, 'yyyy-MM-dd HH:mm')}">2025-12-01 10:00</td>
            <td th:text="${reg.attended ? 'Yes' : 'No'}">No</td>
            <td>
                <form th:action="@{/admin/events/attendance/mark}" method="post" class="d-inline">
                    <input type="hidden" name="registrationId" th:value="${reg.id}" />
                    <input type="hidden" name="attended" th:value="${!reg.attended}" />
                    <button type="submit"
                            th:text="${reg.attended ? 'Mark Absent' : 'Mark Attended'}"
                            class="btn btn-sm"
                            th:classappend="${reg.attended ? 'btn-warning' : 'btn-success'}">
                    </button>
                </form>
            </td>
        </tr>
        <tr th:if="${registrations == null or registrations.empty}">
            <td colspan="4" class="text-center">No registrations found.</td>
        </tr>
        </tbody>
    </table>

    <a th:href="@{/admin/events}" class="btn btn-secondary">Back to Events</a>
</div>

</body>
</html>
